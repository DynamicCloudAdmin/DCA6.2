Azure Subscriptions Unused DetailsTWO#CredCode## Get the list of all Azure subscriptions
Azure Subscriptions Unused DetailsTWO#CredCode#$subscriptions = Get-AzSubscription
Azure Subscriptions Unused DetailsTWO#CredCode## Loop through each subscription
Azure Subscriptions Unused DetailsTWO#CredCode#foreach ($subscription in $subscriptions)
Azure Subscriptions Unused DetailsTWO#CredCode#{
Azure Subscriptions Unused DetailsTWO#CredCode#    # Set the current subscription
Azure Subscriptions Unused DetailsTWO#CredCode#    Select-AzSubscription -SubscriptionId $subscription.SubscriptionId
Azure Subscriptions Unused DetailsTWO#CredCode#    # Get the list of all resources in the subscription
Azure Subscriptions Unused DetailsTWO#CredCode#    $resources = Get-AzResource
Azure Subscriptions Unused DetailsTWO#CredCode#    # Loop through each resource
Azure Subscriptions Unused DetailsTWO#CredCode#    foreach ($resource in $resources)
Azure Subscriptions Unused DetailsTWO#CredCode#    {
Azure Subscriptions Unused DetailsTWO#CredCode#        # Get the resource usage details
Azure Subscriptions Unused DetailsTWO#CredCode#        $usage = Get-AzResourceUsage -ResourceId $resource.ResourceId
Azure Subscriptions Unused DetailsTWO#CredCode#        # Export the usage details to a CSV file
Azure Subscriptions Unused DetailsTWO#CredCode#        $usage | Export-Csv -Path $FinalResultFile -NoTypeInformation -Append
Azure Subscriptions Unused DetailsTWO#CredCode#    }
Azure Subscriptions Unused DetailsTWO#CredCode#}
Azure Subscriptions Unused DetailsTWO#CredCode#
